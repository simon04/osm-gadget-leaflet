var S=Object.defineProperty,O=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var x=(a,t,o)=>t in a?S(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,b=(a,t)=>{for(var o in t||(t={}))L.call(t,o)&&x(a,o,t[o]);if(w)for(var o of w(t))M.call(t,o)&&x(a,o,t[o]);return a},k=(a,t)=>O(a,T(t));import{l as n,w as W,i as U,a as z,s as I,G as C}from"./vendor.71dcccd4.js";const N=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function o(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?s.credentials="include":e.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(e){if(e.ep)return;e.ep=!0;const s=o(e);fetch(e.href,s)}};N();class f extends n.exports.GeoJSON{constructor(t){super(void 0,t);if(this.options={url:void 0,gsnamespace:0,icon:void 0,iconThumbnail:!1,thumbnailWidth:320},n.exports.Util.setOptions(this,k(b({},t),{pointToLayer:t.iconThumbnail?this.pointToThumbnailLayer.bind(this):this.pointToIconLayer.bind(this)})),!this.options.iconThumbnail&&!this.options.icon)throw new Error("Either iconThumbnail or icon is needed!")}onAdd(t){return super.onAdd(t),t.on("zoomend moveend",this.updateMarks,this),this.updateMarks(),this}onRemove(t){return super.onRemove(t),t.off("zoomend moveend",this.updateMarks,this),this}pointToThumbnailLayer(t,o){const i=this._map.getZoom(),e=i>20?320:i>18?240:i>16?120:60,s=t.properties.thumbnail(320);if(!s)return;const r=n.exports.icon({iconUrl:s,iconAnchor:[e/2,0],iconSize:[e,void 0]}),p=n.exports.marker(o,{icon:r,title:t.properties.title});return t.properties.wikipediaUrl&&(p.on("click",()=>window.open(t.properties.wikipediaUrl)),p.on("mouseover",c=>{const d=c.target._icon;d.setAttribute("zIndexOld",d.style.zIndex),d.style.zIndex="987654"}),p.on("mouseout",c=>{const d=c.target._icon;d.style.zIndex=d.getAttribute("zIndexOld")})),p}pointToIconLayer(t,o){const i=n.exports.icon(this.options.icon),e=n.exports.marker(o,{icon:i,title:t.properties.title}),s=r.call(this,t);return s&&(e.bindPopup(s,{minWidth:200}),e.on("click",function(){this.openPopup(),this.openedViaMouseOver=!1}),e.on("mouseover",function(){this.openPopup(),this.openedViaMouseOver=!0}),e.on("mouseout",function(){this.openedViaMouseOver&&this.closePopup()})),e;function r(p){let c;if(p.properties.title&&p.properties.wikipediaUrl&&(c=n.exports.Util.template('<a href="{wikipediaUrl}" target="_blank">{title}</a>',p.properties),p.properties.thumbnail)){const{thumbnailWidth:d}=this.options,v=p.properties.thumbnail(d);c+=n.exports.Util.template('<p><img src="{thumbnail}" width="{thumbnailWidth}"></p>',{thumbnail:v,thumbnailWidth:d})}return c}}updateMarks(){if(!this._map)return;const t=this._map.getBounds();let o=this.options.url+"/w/api.php";o+=n.exports.Util.getParamString({origin:"*",format:"json",action:"query",list:"geosearch",gsnamespace:this.options.gsnamespace,gslimit:500,gsprop:"type|name",gsbbox:[t.getNorth(),t.getWest(),t.getSouth(),t.getEast()].join("|")});const i=new XMLHttpRequest;return i.addEventListener("load",e.bind(this)),i.open("GET",o),i.send(),this;function e(){if(i.status!==200||!i.responseText)return;const r=JSON.parse(i.responseText);if(r.error||!r.query.geosearch){console.warn(r.error);return}const c=r.query.geosearch.map(s,this);this.clearLayers(),this.addData(c)}function s(r){return{type:"Feature",geometry:{type:"Point",coordinates:[r.lon,r.lat]},properties:{title:r.title,wikipediaUrl:this.options.url+"/wiki/"+r.title,thumbnail:r.title.match(/^File:/)?p=>W(r.title,p):void 0}}}}}class P extends n.exports.GeoJSON{constructor(t){super(void 0,t);this.options={coordsToLatLng(o){const i=n.exports.point(o[0],o[1]);return n.exports.Projection.SphericalMercator.unproject(i)},pointToLayer(o,i){return n.exports.circleMarker(i)}},n.exports.Util.setOptions(this,t)}loadWIWOSM(){if(!(!this.options.article||!this.options.lang))return typeof this.options.article=="object"?(this.clearLayers(),this.options.article.map(t=>this.loadArticle(t))):this.loadArticle(this.options.article,!0),this}loadArticle(t,o=!1){let i="https://tools.wmflabs.org/wiwosm/osmjson/getGeoJSON.php";i+=n.exports.Util.getParamString({lang:this.options.lang,article:t});const e=new XMLHttpRequest;e.addEventListener("load",()=>{if(e.status!==200||!e.responseText)return;const s=JSON.parse(e.responseText);o&&this.clearLayers(),this.addData(s),this._map.fitBounds(this.getBounds())}),e.open("GET",i),e.send()}}function y(){return new URLSearchParams((location.hash||"").substring(2))}function _(a){const t=y();if(t.has("lat")&&t.has("lon"))a.setView([+t.get("lat"),+t.get("lon")],+t.get("zoom")||9);else{const o=window.localStorage?window.localStorage.getItem("mapCenter"):void 0;let i=!1;if(typeof o=="string")try{const e=JSON.parse(o);a.setView(e,e.zoom),i=!0}catch{}i||a.setView({lat:47.3,lng:11.3},9)}}function A(){if(!window.localStorage)return;const a={lat:this.getCenter().lat,lng:this.getCenter().lng,zoom:this.getZoom()};window.localStorage.setItem("mapCenter",JSON.stringify(a))}const h=y();delete n.exports.Icon.Default.prototype._getIconUrl;n.exports.Icon.Default.mergeOptions({iconRetinaUrl:U,iconUrl:z,shadowUrl:I});const l=n.exports.map("map");l.attributionControl.setPrefix('<a href="https://github.com/simon04/osm-gadget-leaflet/" target="_blank">@simon04/osm-gadget-leaflet</a> (GPL v3)');new C({position:"topleft"}).addTo(l);_(l);const u=new P({article:h.get("article"),lang:h.get("lang")||"en"}),E=new f({url:"https://commons.wikimedia.org",iconThumbnail:!0,gsnamespace:6}),G=new f({url:"https://commons.wikimedia.org",icon:{iconUrl:"https://upload.wikimedia.org/wikipedia/commons/thumb/e/e9/Commons-logo-2.svg/20px-Commons-logo-2.svg.png",iconSize:[20,27]},gsnamespace:6}),g=new f({url:"https://"+(h.get("lang")||"en")+".wikipedia.org",icon:{iconUrl:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Wikipedia-logo-v2.svg/20px-Wikipedia-logo-v2.svg.png",iconSize:[20,18]}}),m=24,q=n.exports.control.layers({Wikimedia:n.exports.tileLayer("https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",{maxNativeZoom:19,maxZoom:m,attribution:'<a href="https://wikimediafoundation.org/wiki/Maps_Terms_of_Use">Wikimedia</a>'}).addTo(l),OpenStreetMap:n.exports.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxNativeZoom:19,maxZoom:m,attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),OpenTopoMap:n.exports.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{maxNativeZoom:17,maxZoom:m,attribution:'&copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>), <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'})},{WIWOSM:u.addTo(l),"Commons World \u{1F5BC}":E.addTo(l),"Commons World":G,"Wikipedia World":g.addTo(l).updateMarks()}).addTo(l);h.get("lang")==="de"&&q.addBaseLayer(n.exports.tileLayer("https://{s}.tile.openstreetmap.de/{z}/{x}/{y}.png",{maxNativeZoom:18,maxZoom:m,attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),"OpenStreetMap.de");n.exports.control.scale().addTo(l);u.loadWIWOSM();window.addEventListener("hashchange",function(){n.exports.Util.setOptions(u,y()),u.loadWIWOSM()});l.on("zoomend moveend",g.updateMarks,g);l.on("zoomend moveend",A,l);
//# sourceMappingURL=index.d66f5992.js.map
